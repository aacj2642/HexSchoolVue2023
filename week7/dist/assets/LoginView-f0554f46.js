import{_ as p,m as h,k as m,o as u,c as g,b as e,l as _,i as d,v as c,F as f,h as w,g as l,q as k,s as L}from"./index-23a7658d.js";import{l as v,e as b}from"./apiPath-bdbb9eb3.js";const x={data(){return{username:"",password:""}},methods:{...h(l,["setLoading","setIsLogin"]),login(){this.setLoading(1),this.$http.post(v,{username:this.username,password:this.password}).then(s=>{const{token:t,expired:r}=s.data;document.cookie=`token=${t};expires=${new Date(r)};`,this.setIsLogin(!0),this.$router.push("/admin/products/1")}).catch(s=>{this.setIsLogin(!1),alert(`Error: ${s.message}`)}).then(()=>{this.setLoading(-1)})},checkAuth(){this.setLoading(1);const s=document.cookie.replace(/(?:(?:^|.*;\s*)token\s*=\s*([^;]*).*$)|^.*$/,"$1");s.length!=0?(this.$http.defaults.headers.common.Authorization=s,this.checkToken()):(this.setIsLogin(!1),this.setLoading(-1))},checkToken(){this.$http.post(b).then(s=>{s.data.success&&(this.setIsLogin(!0),this.$router.push("/admin/products/1"))}).catch(s=>{this.setIsLogin(!1),alert(s.response.data.message)}).then(()=>{this.setLoading(-1)})}},computed:{...m(l,["loading"]),isLoading(){return this.loading>0}},mounted(){this.checkAuth()}},n=s=>(k("data-v-dd720c2f"),s=s(),L(),s),I={class:"row justify-content-center"},y={class:"col-8"},$={class:"form-floating mb-3"},S=n(()=>e("label",{for:"username"},"Email address",-1)),V={class:"form-floating"},A=n(()=>e("label",{for:"password"},"Password",-1)),U=n(()=>e("button",{class:"btn btn-lg btn-primary w-100 mt-3",type:"submit"},[e("span",null," 登入 ")],-1)),q=n(()=>e("p",{class:"mt-5 mb-3 text-muted text-center"},"© 2022~∞ - 六角學院",-1));function B(s,t,r,E,a,i){return i.isLoading?w("",!0):(u(),g(f,{key:0},[e("div",I,[e("div",y,[e("form",{id:"form",class:"form-signin",onSubmit:t[2]||(t[2]=_((...o)=>i.login&&i.login(...o),["prevent"]))},[e("div",$,[d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>a.username=o),type:"email",class:"form-control",id:"username",placeholder:"name@example.com",required:"",autofocus:""},null,512),[[c,a.username]]),S]),e("div",V,[d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.password=o),type:"password",class:"form-control",id:"password",placeholder:"Password",required:""},null,512),[[c,a.password]]),A]),U],32)])]),q],64))}const F=p(x,[["render",B],["__scopeId","data-v-dd720c2f"]]);export{F as default};
